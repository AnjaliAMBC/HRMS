
@{
    ViewBag.Title = "EmpTimesheetView";
}
@Html.Partial("_EmployeeNavbar")
<div class="container-fluid emp-timesheet-list-horizon">
    <div class="main-content container-fluid">
        <div class="content employee-timesheet">
            <div class="emp-timesheet-container">
                <div class="row res-emp-timesheet-header">
                    <div class="col-lg-3 res-emp-timesheet-title">
                        <h4>Timesheet</h4>
                    </div>
                </div>
            </div>

            <div class="emp-timesheet-details timesheet-nav" id="empTimesheet">

                <div class="emp-timesheet-header-block">
                    <div class="emp-timesheet-header-block-left">
                        <div class="emp-timesheet-block1">
                            <span class="emp-timesheet-weekno">Week 42</span>
                            <span class="emp-timesheet-weekrange-info">
                                <i class="fa fa-angle-left" aria-hidden="true"></i>
                                <span class="emp-timesheet-weekrange">04 November 2024 <i class="fa fa-long-arrow-right" aria-hidden="true"></i> 10 November 2024</span>
                                <i class="fa fa-angle-right" aria-hidden="true"></i>
                            </span>
                        </div>
                        <div class="emp-timesheet-block2">
                            <div class="form-group col-lg-12 div-timesheet-company">
                                <select class="form-control" id="entertimesheetCompany">
                                    <option value="1">AMBC</option>
                                </select>
                            </div>
                        </div>
                        <div class="emp-timesheet-block3">
                            <span>Reporting Manager </span> Shanta M Balakumar
                        </div>
                    </div>
                    <div class="emp-timesheet-header-block-right">
                        <button type="button" class="btn btn-primary timesheet-Submit">Enter Timesheet</button>
                    </div>
                </div>

                <div class="emp-timesheet-graph-block">
                    <div class="emp-timesheet-hours-spent">
                        <div class="emp-timesheet-block-content emp-timesheet-block-bar">
                            <div id="emp-timesheet-hours-spent" style="height: 270px; width: 100%;"></div>
                        </div>
                    </div>
                    <div class="emp-timesheet-attendance">
                        <div class="emp-timesheet-block-content emp-timesheet-block-donut">
                            <div class="emp-timesheet-block-donut-title">Hours Spent</div>
                            <canvas id="emp-timesheet-attendance" style="width:100%;max-width:100%"></canvas>
                        </div>
                    </div>
                </div>


                <div class="emp-timesheet-table-block">
                    <div class="emp-timesheet-table-header">
                        <div class="emp-timesheet-table-title">Task List</div>
                        <div class="emp-timesheet-table-submit"><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#empSubmitTimesheetModal">Submit Timesheet</button></div>
                    </div>
                    <div class="emp-timesheet-table-body">
                        <div class="emp-timesheet-body table-responsive">
                            <table id="emptimesheetlistingTable" class="table emp-timesheet-table" style="width: 100%; color: #272727">
                                <thead style=" background-color: #3E78CF; border-radius: 10px;">
                                    <tr>
                                        <th>Date</th>
                                        <th>Category</th>
                                        <th>Task/Incident Name</th>
                                        <th>Task/Incident Description</th>
                                        <th>Priority</th>
                                        <th>Requester</th>
                                        <th>Status</th>
                                        <th>Total Hours</th>
                                        <th>Action</th>
                                    </tr>
                                </thead>
                                <tbody id="emptimesheetBody">
                                    <tr>
                                        <td>07-11-2024</td>
                                        <td>Support</td>
                                        <td>HRMS</td>
                                        <td>Help Desk Tickets and IDERA Monitoring & Diskspace</td>
                                        <td>Medium</td>
                                        <td>Medium</td>
                                        <td>Closed</td>
                                        <td>0.90</td>
                                        <td>
                                            <i class="fas fa-ellipsis-v emp-timesheet-edit" onclick="toggleEmpTimesheetActionOptions(this)"></i>
                                            <div class="emp-timesheetoptions" style="display:none">
                                                <a class="dropdown-item emp-timesheet-edit-btn"
                                                   data-timesheetname="1">Edit</a>
                                                <a class="dropdown-item emp-timesheet-cancel"
                                                   onclick="emptimesheetcancel($(this))"
                                                   data-timesheetname="1">Delete</a>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>07-11-2024</td>
                                        <td>Support</td>
                                        <td>HRMS</td>
                                        <td>Help Desk Tickets and IDERA Monitoring & Diskspace</td>
                                        <td>Medium</td>
                                        <td>Medium</td>
                                        <td>Closed</td>
                                        <td>0.90</td>
                                        <td>
                                            <i class="fas fa-ellipsis-v emp-timesheet-edit" onclick="toggleEmpTimesheetActionOptions(this)"></i>
                                            <div class="emp-timesheetoptions" style="display:none">
                                                <a class="dropdown-item emp-timesheet-edit-btn"
                                                   data-timesheetname="1">Edit</a>
                                                <a class="dropdown-item emp-timesheet-cancel"
                                                   onclick="emptimesheetcancel($(this))"
                                                   data-timesheetname="1">Delete</a>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<!-- Submit Timesheet Modal -->
<div id="empSubmitTimesheetModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="empSubmitTimesheetModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="far fa-times-circle"></i>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to submit timesheet (06 November 2024 to 10 November 2024)
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                <button type="button" class="btn" data-ticketname="" id="empSubmitTimesheetSubmitButton">Yes</button>
            </div>
        </div>
    </div>
</div>

<!-- Confirmation Modal -->
<div id="empTimesheetConfirmCancelModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="empTimesheetConfirmCancelModal" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="far fa-times-circle"></i>
                </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete this timesheet?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
                <button type="button" class="btn" data-ticketname="" id="empTimesheetConfirmCancelButton">Yes</button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
<script>
    $(document).ready(function () {
        var dataPoints1 = [
            { label: "4-11-2024", y: 0, indexLabel: "" },
            { label: "5-11-2024", y: 0, indexLabel: "" },
            { label: "6-11-2024", y: 0, indexLabel: "" },
            { label: "7-11-2024", y: 0.2, indexLabel: "Leave" },
            { label: "8-11-2024", y: 0, indexLabel: "" },
            { label: "9-11-2024", y: 0, indexLabel: "" },
            { label: "10-11-2024", y: 0, indexLabel: "" }
        ];

        var dataPoints2 = [
            { label: "4-11-2024", y: 0, indexLabel: "" },
            { label: "5-11-2024", y: 0, indexLabel: "" },
            { label: "6-11-2024", y: 0, indexLabel: "" },
            { label: "7-11-2024", y: 0, indexLabel: "" },
            { label: "8-11-2024", y: 0.2, indexLabel: "Holiday" },
            { label: "9-11-2024", y: 0, indexLabel: "" },
            { label: "10-11-2024", y: 0, indexLabel: "" }
        ];

        var dataPoints3 = [
            { label: "4-11-2024", y: 0, indexLabel: "" },
            { label: "5-11-2024", y: 0, indexLabel: "" },
            { label: "6-11-2024", y: 0, indexLabel: "" },
            { label: "7-11-2024", y: 0, indexLabel: "" },
            { label: "8-11-2024", y: 0, indexLabel: "" },
            { label: "9-11-2024", y: 0.2, indexLabel: "Weekend" },
            { label: "10-11-2024", y: 0.2, indexLabel: "Weekend" }
        ];

        var dataPoints4 = [
            { label: "4-11-2024", y: 8, indexLabel: "Hours Spent" },
            { label: "5-11-2024", y: 8.10, indexLabel: "Hours Spent" },
            { label: "6-11-2024", y: 0, indexLabel: "" },
            { label: "7-11-2024", y: 0, indexLabel: "" },
            { label: "8-11-2024", y: 0, indexLabel: "" },
            { label: "9-11-2024", y: 0, indexLabel: "" },
            { label: "10-11-2024", y: 0, indexLabel: "" }
        ];

        var dataPoints5 = [
            { label: "4-11-2024", y: 1, indexLabel: "Overtime" },
            { label: "5-11-2024", y: 0.10, indexLabel: "Overtime" },
            { label: "6-11-2024", y: 0, indexLabel: "" },
            { label: "7-11-2024", y: 0, indexLabel: "" },
            { label: "8-11-2024", y: 0, indexLabel: "" },
            { label: "9-11-2024", y: 0, indexLabel: "" },
            { label: "10-11-2024", y: 0, indexLabel: "" }
        ];

        var chart = new CanvasJS.Chart("emp-timesheet-hours-spent", {
            axisY: {
                suffix: " h",
                interval: 2,
                minimum: 0,
                gridThickness: 0,
                lineThickness: 0
            },
            data: [
                {
                    type: "stackedColumn",
                    name: "Leave",
                    showInLegend: false,
                    color: "#FF5733",
                    yValueFormatString: "#,##0 h",
                    dataPoints: dataPoints1
                },
                {
                    type: "stackedColumn",
                    name: "Hoilday",
                    showInLegend: false,
                    color: "#FFC300",
                    yValueFormatString: "#,##0 h",
                    dataPoints: dataPoints2
                },
                {
                    type: "stackedColumn",
                    name: "Week End",
                    showInLegend: false,
                    color: "#3e4652",
                    yValueFormatString: "#,##0 h",
                    dataPoints: dataPoints3
                },
                {
                    type: "stackedColumn",
                    name: "Hours Spent",
                    showInLegend: false,
                    color: "#33FF57",
                    yValueFormatString: "#,##0 h",
                    dataPoints: dataPoints4
                },
                {
                    type: "stackedColumn",
                    name: "Overtime",
                    showInLegend: false,
                    color: "#50aced",
                    yValueFormatString: "#,##0 h",
                    dataPoints: dataPoints5
                }

            ]
        });

        chart.render();

        function toggleDataSeries(e) {
            if (typeof (e.dataSeries.visible) === "undefined" || e.dataSeries.visible) {
                e.dataSeries.visible = false;
            } else {
                e.dataSeries.visible = true;
            }
            chart.render();
        }

    });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
<script>
    var xValues = ["Hours Spent", "Overtime"];
    var yValues = [16, 1.10];
    var barColors = [
        "#33FF57",
        "#50aced"
    ];

    new Chart("emp-timesheet-attendance", {
        type: "doughnut",
        data: {
            labels: xValues,
            datasets: [{
                backgroundColor: barColors,
                data: yValues
            }]
        },
        options: {
            legend: {
                display: true,
                position: 'bottom'
            },
            hover: {
                mode: null
            },
            animation: {
                duration: 0
            }
        }
    });

</script>
<script src="~/Scripts/z-Timesheet.js"></script>
<script>
    $(document).ready(function () {
        var table = $('#emptimesheetlistingTable').DataTable({
            "paging": true,
            "searching": false,
            "ordering": false,
            "info": true,
            "autoWidth": false,
        });
    });

    function toggleEmpTimesheetActionOptions(iconElement) {
        const optionsMenu = $(iconElement).next('.emp-timesheetoptions');
        $('.emp-timesheetoptions').not(optionsMenu).hide();
        optionsMenu.toggle();
        $(document).on('click.hideMenu', function (event) {
            if (!$(event.target).closest(iconElement).length && !$(event.target).closest('.emp-timesheetoptions').length) {
                optionsMenu.hide();
                $(document).off('click.hideMenu');
            }
        });
    }

    function emptimesheetcancel(currentthis) {
        currentSelectedrow = currentthis.closest('tr');
        var timesheetName = currentthis.attr("data-timesheetname");
        $('#empTimesheetConfirmCancelButton').attr('data-timesheetname', timesheetName);
        $('#empTimesheetConfirmCancelModal .modal-body').html('Are you sure you want to delete this task?');
        $('#empTimesheetConfirmCancelButton').attr('disabled', false);
        $('#empTimesheetConfirmCancelModal').modal('show');
    }


</script>

